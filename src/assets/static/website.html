<!doctype html>
<html>

<head>

    <title>Growth99+</title>
    <base href="/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="google-site-verification" content="Y45XADXl0rKLMhCw7mJchWEyrW7o2AOD8dXlW_Qua8U" />
    <link rel="icon" type="image/x-icon" href="https://g99plus.b-cdn.net/AEMR/assets/img/growth99_icon.png" />
    <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap library -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js" integrity="sha512-qTXRIMyZIFb8iQcfjXWCO8+M5Tbc38Qi5WzdPOYZHIlZpzBHG3L3by84BBBOiRGiEb7KKtAOAs5qYdUiZiQNNQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        body {
            margin: 0;
            font-family: sans-serif;
        }

        #landingPage>p {
            margin: 0;
        }

        #thankyou {
            display: none;
            background-color: #fff;
            padding: 100px 0;
        }

        #thankyou.show {
            display: block;
        }

        div#loading .loaderModal {
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 320px;
            align-items: center;
            justify-content: center;
        }

        div#loading .loaderModal img {
            max-width: 50%;
        }

        #myModal .modal-dialog {
            max-width: 55%;
        }

        .modal {
            z-index: 9999999;
        }

        .reviews iframe {
            max-height: 500px;
        }

        .service-wrapper2 .sdescription {
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            margin: 0;
        }

        #formWrapper {
            padding: 20px;
        }

        button.close {
            background-color: transparent !important;
            cursor: pointer;
            position: absolute;
            float: none;
            right: 0;
            z-index: 1;
            top: 0;
            opacity: 1;
        }

        .app-row {
            margin: 15px 0 0 0;
        }

        .app-row .label {
            display: block;
            margin: 0 0 5px;
        }

        button {
            cursor: pointer;
            border: none;
            outline: none;
        }

        .modal-body {
            padding: 0 0 1em !important;
            min-height: 350px;
        }

        .close {
            margin-right: 5px;
            margin-top: 5px;
        }

        .service-header {
            padding: 1em;
            text-align: center;
        }

        .service-body {
            margin-top: 1em;
        }

        input,
        textarea,
        select {
            display: block;
            width: calc(100% - 1.8rem);
            padding: .375rem .75rem;
            font-size: 1rem;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: .25rem;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
            outline: 0;
        }

        button,
        input:focus,
        textarea:focus,
        select:focus {
            text-decoration: none;
            outline: 0;
            /*border: 0px;*/
        }

        .btn-submit {
            background-color: rgb(0, 59, 111);
            border: rgb(0, 59, 111);
            color: rgb(255, 255, 255);
            border-radius: 30px;
            height: 45px;
            padding: 0 30px;
            cursor: pointer;
            outline: 0;
        }

        .required {
            color: red;
        }

        .overlay {
            display: none;
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 999;
            background: rgba(255, 255, 255, 0.8);
            /*  url("loader.gif") center no-repeat */
        }
        /* Turn off scrollbar when body element has the loading class */

        body.loading {
            overflow: auto;
        }
        /* Make spinner image visible when body element has the loading class */

        body.loading .overlay {
            display: block;
        }

        input.radio {
            display: inline-block;
            max-width: 15px;
        }

        .head {
            height: 130px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 3em;
            z-index: 2;
            position: relative;
        }

        .logo {
            font-family: 'Raleway', sans-serif;
            font-style: normal;
            font-weight: 500;
            font-size: 28px;
            line-height: 21px;
            color: #000;
        }

        .address {
            font-family: 'Raleway', sans-serif;
            font-style: normal;
            font-weight: normal;
            font-size: 18px;
            line-height: 21px;
            color: #4E4244;
        }

        .logo img {
            max-width: 120px;
            max-height: 80px;
        }

        .address {
            font-family: Raleway, sans-serif;
            font-style: normal;
            font-weight: normal;
            font-size: 18px;
            line-height: 21px;
            color: rgb(78, 66, 68);
        }

        .address p.businessname {
            font-style: normal;
            font-weight: 700;
            font-size: 18px;
            line-height: 21px;
            color: rgb(78, 66, 68);
            margin-bottom: 0px;
        }

        .address p.businessAddress {
            font-size: 14px;
            line-height: 20px;
            padding-top: 10px;
            margin-bottom: 0;
        }

        .text-center.reviewButtonCode {
            display: flex;
            justify-content: center;
            margin: 0 auto;
            max-width: 126px;
        }

        .reviews {
            margin-top: 2em;
        }

        .text-center.reviewButtonCode button {
            position: absolute;
            height: 50px;
            width: 125px;
            border: none;
            cursor: pointer;
            margin-bottom: 2em;
        }

        .text-center.reviewButtonCode>div {
            opacity: 0;
            max-height: 50px;
        }

        @media screen and (max-width:767px) {
            .head {
                padding: 2em 1em;
                justify-content: space-between;
                align-items: center;
            }
            .head .logo {
                padding-bottom: 10px;
                padding-right: 10px;
            }
            .address {
                font-size: 14px;
            }
            .head {
                height: auto;
                max-height: 100px;
            }
        }

        .img-wrapper2 {
            text-align: center;
            padding-bottom: 40px;
        }

        .img-wrapper2 p {
            padding-top: 15px;
        }

        .img-wrapper2 p.small-text {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: left;
            font-style: normal;
            font-weight: normal;
            font-size: 14px;
            line-height: 171.5%;
            /* or 24px */
            text-align: left !important;
            color: #000000;
        }

        .img-wrapper2 .content2 {
            max-width: 270px;
            margin: 0 auto;
        }

        .img-wrapper4 p.titlep {
            padding-top: 10px;
            padding-bottom: 0 !important;
        }

        .img-wrapper4 p.small-text {
            padding-top: 0 !important;
            padding-bottom: 10px !important;
            font-size: 16px;
        }

        .img-wrapper4 {
            max-width: 300px;
            margin: 0 auto;
            text-align: center;
            padding: 1em 1em 1em;
            box-shadow: rgb(143 143 143 / 15%) 2px 0px 20px 9px;
        }

        .buttons-wrapper {
            display: flex;
            justify-content: space-around;
        }

        #loadingDiv {
            border: 5px solid #f3f3f3;
            -webkit-animation: spin 1s linear infinite;
            animation: spin 1s linear infinite;
            border-top: 5px solid #555;
            border-radius: 50%;
            width: 50px;
            height: 50px;
        }

        #parentLoader {
            height: 100vh;
            width: 100%;
            margin: 0 auto;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #parentLoader+#landingPage {
            display: none;
        }

        .user-info-wrapper {
            margin-top: 1em;
        }

        .service-right p {
            font-size: 14px;
        }

        .img-wrapper2 .img21 {
            display: flex;
            position: relative;
            justify-content: center;
        }

        #userdiv .img-wrapper4 {
            padding: 1em !important
        }

        .img-wrapper2 .circle-img {
            background: #50e3c2;
            position: absolute;
            border-radius: 50%;
            z-index: -1;
            margin-left: -4em;
            top: -8px;
            height: 80px;
            width: 80px;
        }

        .user-clinics ul {
            list-style-type: circle;
            margin-left: 0;
            padding-left: 1em;
        }

        #service .row,
        #users .row {
            justify-content: center;
        }

        #service-insert .col-lg-4 {
            margin-top: 2em;
        }

        #users .img-wrapper4 {
            margin-bottom: 2em
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>


</head>

<body>
    <div id="parentLoader"></div>
    <div id="landingPage"></div>


    <div id="users"></div>

    <div id="chatbot"></div>

    <script>
        // localStorage.removeItem("color")
        // localStorage.removeItem("color")
        $('#parentLoader').append('<div style="" id="loadingDiv"></div><div class="loader"><b>Loading...</b></div>');
        $(window).on('load', function() {
            setTimeout(removeLoader, 1000); //wait for page load PLUS two seconds.
        });

        $(window).on('resize', function() {
            var win = $(this); //this = window

            if (win.width() >= 768) {
                $(".main-menu").css("background", "none")
            }

            if (win.width() <= 768) {
                $(".main-menu.active").css("background", "transparent")
            }
        });

        function removeLoader() {
            $("#loadingDiv").fadeOut(500, function() {
                // fadeOut complete. Remove the loading div
                $("#parentLoader").remove();
                $(".loader").remove() //makes page more lightweight
            });
        }


        function myFunction(targetId) {

            scrollTop = 0
            event.preventDefault();
            targetId = "#" + targetId


            $('html, body').animate({

                scrollTop: $(targetId).offset().top - 50
            }, 'slow');


        }
        var chatbotDomain = ""
        var chatbotHostName = ''
        var domain = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');
        if (location.hostname.includes("devemr")) {
            chatbotHostName = location.hostname.replace("devemr", "chatbot")
        } else if (location.hostname.includes("app")) {
            chatbotHostName = location.hostname.replace("app", "chatbot")
        } else {
            chatbotHostName = location.hostname.replace("app", "chatbot")
        }


        chatbotDomain = location.protocol + '//' + chatbotHostName + (location.port ? ':' + location.port : '');

        if (location.hostname.includes("localhost")) {
            chatbotDomain = "https://chatbot.growthemr.com"
        }
        var formurl, trackingCode, lpname1;
        var buttoncss;
        var variables = getUrlVars();
        var ClinicUrl
        var defaultClinicId = ''
        bid = variables['bid'];
        fid = variables['lpid'];

        var formurl, trackingCode, lpname1;
        var buttoncss;
        let SymptomComposerUrl = domain + '/assets/static/composer.html?bid=' + bid + "&lpid=" + fid
        var gloabl_fgColor
        var gloabl_bgColor
        var gloabl_bgColorLight
        var global_bgColor_noOpactiy
            // $(document).on('click', 'button.btn-fixed1', function() {
            //     if ($('.btn-fixed ').length) {
            //         window.open(ClinicUrl, '_blank');
            //     }
            // });

        // function is called for service click
        $(document).on('click', '.service-wrapper2 a', function() {
            $("#loading").css("display", "block");
            $.ajax({
                url: getApiUrl() + "/api/public/v1/service/" + this.id,
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },
                success: function(data, textStatus) {
                    $("#loading").css("display", "none");
                    $("#service-data  .user-info-wrapper").css("display", "none")
                    $("#service-data").css("display", "block");
                    $("#service-data h3").text(data.name)
                    if (!data.imageUrl) {
                        data.imageUrl = "https://t4.ftcdn.net/jpg/01/39/44/01/360_F_139440171_VO4UiFCi25cYSVyVnUgGCaTwW7oJ94pV.jpg"
                    }
                    if (!data.description) {
                        data.description = "Service description not found"
                    }
                    console.log(gloabl_bgColorLight, gloabl_fgColor, gloabl_bgColor)
                    let bookurl = domain + "/ap-booking/business?b=" + bid + "&c=" + defaultClinicId + "&lpid=" + fid + "&service=" + data.id + '&bgColor=' + gloabl_bgColor.trim() + '&color=' + gloabl_fgColor.trim()
                        // let bookurl = domain + "/ap-booking/business?b=" + '&bgColor=' + gloabl_bgColor.trim() + '&color=' + gloabl_fgColor.trim()
                    bookurl = bookurl.replace(/\s/g, "%20");
                    $("#service-data .bgColor").css("background-color", gloabl_bgColorLight);
                    $("#service-data .fgColor").css("color", gloabl_bgColor);
                    $("#service-data img").attr("src", data.imageUrl)
                    $("#service-data .service-title h4").text(data.name)
                    $("#service-data .service-description p").text(data.description)
                    $("#service-data .service-other .duration").text(data.durationInMinutes)
                    $("#service-data .service-other .cost").text(data.serviceCost)
                    $("#service-data .service-other .category").text(data.serviceCategory.name)
                    $("#service-data .service-btn  button").html("<a class='btnFgColor' target='_blank' href=" + bookurl + ">Book Now </a>")
                    $("#service-data .fgColor").css("color", gloabl_bgColor);
                    $("#service-data .btnFgColor").css("color", gloabl_fgColor);
                }
            })
        });


        // function is called when clicked on show users
        $(document).on('click', '.buttons-wrapper .btn-book', function() {
            let bookurl = this.value
            $("#loading").css("display", "block");
            $("#service-data  .user-info-wrapper").css("display", "block")
            $.ajax({
                url: getApiUrl() + "/api/public/users/" + this.id,
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },
                success: function(data, textStatus) {
                    $("#loading").css("display", "none");

                    $("#service-data").css("display", "block");
                    $("#service-data h3").text(data.firstName + " " + data.lastName)
                    if (!data.profileImageUrl) {
                        data.profileImageUrl = "https://t4.ftcdn.net/jpg/01/39/44/01/360_F_139440171_VO4UiFCi25cYSVyVnUgGCaTwW7oJ94pV.jpg"
                    }
                    if (!data.description) {
                        data.description = "About information user not found"
                    }
                    $("#service-data .bgColor").css("background-color", gloabl_bgColorLight);
                    $("#service-data img").attr("src", data.profileImageUrl)
                    $("#service-data .service-title h4").text(data.firstName + " " + data.lastName)
                    $("#service-data .service-description p").text(data.description)
                    $("#service-data .service-btn  button").removeClass("btn-fixed")
                    $("#service-data .service-btn  button").html("<a class='btnFgColor' target='_blank' href=" + bookurl + ">Book Now </a>")
                    $("#service-data .service-other").css("display", "none")
                    let clinicsHtml = "<ul>"
                    data.clinics.forEach(data => {
                        clinicsHtml += "<li><p style='margin-bottom:5px'><a target='_blank' href='" + data.clinic.clinicUrl + "'>" + data.clinic.name + "</a></p></li>"
                    })

                    $("#service-data .fgColor").css("color", gloabl_bgColor);
                    $("#service-data .btnFgColor").css("color", gloabl_fgColor);
                    $("#service-data .user-clinics").html(clinicsHtml)
                    $("#service-data .user-clinics li a").css("color", gloabl_bgColor)
                }
            })
        });

        //closing modal on click of close button
        $(document).on('click', '.modal-body .close', function() {
            $("#service-data").css("display", "none");
        })

        //Hamberger menu js
        $(document).on('click', '#hamburger-icon', function() {

            console.log(global_bgColor_noOpactiy, gloabl_bgColor)
            var menuIcon = $("#hamburger-icon");
            var mainMenu = $(".main-menu");
            var menuItems = $(".main-menu ul li a");
            mainMenu.toggleClass("active");
            menuIcon.toggleClass("active");
            $(".main-menu.active").css("background", gloabl_bgColor)
            $(".main-menu.active a").css("color", gloabl_fgColor)
            $(".main-menu.active").css("background", global_bgColor_noOpactiy)
            $(".main-menu.active .main-list a").css("color", gloabl_bgColor)
            $(".main-menu.active a.fgColorInBg").css("color", gloabl_fgColor)
        })

        $(document).on('click', '.main-menu ul li a', function() {
            var menuIcon = $("#hamburger-icon");
            var mainMenu = $(".main-menu");
            var menuItems = $(".main-menu ul li a");
            menuIcon.toggleClass("active");
            mainMenu.toggleClass("active");
        })

        //hide vertical button on chatbot click
        //overlapping issue of chatbot with vertical button

        $(document).on('click', '.chat-bot-icon', function() {
            if (jQuery(".emr-chat-page").hasClass("show")) {
                jQuery(".btn-vertical button").css("opacity", 0)
            } else {
                jQuery(".btn-vertical button").css("opacity", 1)
            }
        })

        var chatEmbededCode = ""

        $(function() {
            var variables = getUrlVars();
            var formVariables;
            loadLandingPage(variables['bid'], variables['lpid']);
            window.addEventListener('gplus_custom_event', function(e) {
                var url = e.detail.url
                window.top.location = url;
            }, false);

            var cssUrl = 'https://api.growthemr.com' + "/api/public/chatconfigs/css?bid=" + bid;
            let chatUrl = chatbotDomain + "/business/" + bid + "/chat?fid=" + fid;
            chatEmbededCode = '<link rel="stylesheet" href="' + cssUrl + '">' +
                '<div id="emr-chat-div" data-url="' + chatUrl + '" style="bottom: 0; position: fixed; margin: 1em; right: 0; z-index: 998;"></div>' +
                '<script src="' + chatbotDomain + '/assets/js/emr-chat.js"><\/script>';



        });

        function rgbToHex(color) {
            var values = color
                .replace(/rgba?\(/, '')
                .replace(/\)/, '')
                .replace(/[\s+]/g, '')
                .split(',');
            var a = parseFloat(values[3] || 1),
                r = Math.floor(a * parseInt(values[0]) + (1 - a) * 255),
                g = Math.floor(a * parseInt(values[1]) + (1 - a) * 255),
                b = Math.floor(a * parseInt(values[2]) + (1 - a) * 255);
            return "#" +
                ("0" + r.toString(16)).slice(-2) +
                ("0" + g.toString(16)).slice(-2) +
                ("0" + b.toString(16)).slice(-2);
        }

        function hexToRGB(hex, alpha) {
            if (hex) {
                resultcode = ""
                if (hex.startsWith("#")) {
                    var r = parseInt(hex.slice(1, 3), 16),
                        g = parseInt(hex.slice(3, 5), 16),
                        b = parseInt(hex.slice(5, 7), 16);
                    if (alpha) {
                        resultcode = "rgba(" + r + ", " + g + ", " + b + ", " + alpha + ")";
                    } else {
                        resultcode = "rgb(" + r + ", " + g + ", " + b + ")";
                    }
                } else {
                    let new_col = hex.replace(/rgb/i, "rgba");
                    resultcode = new_col.replace(/\)/i, ',0.35)');

                }

                return resultcode
            }

        }


        function loadClinicWorkingTime() {
            let workingHtml = "";
            $.ajax({
                url: getApiUrl() + "/api/public/v1/clinics/default/hour",
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },

                success: function(data, textStatus) {
                    sortDaysOfWeek(data.businessHour)
                    data.businessHour.forEach(day => {
                        if(day.closeHour == null) {
                            workingHtml += "<div class='work-wrapper'><p>" + day.dayOfWeek.substring(0, 3).toLowerCase() + "</p>" + "<p class='hours'> Appointment Only</div>"
                        } else {
                            workingHtml += "<div class='work-wrapper'><p>" + day.dayOfWeek.substring(0, 3).toLowerCase() + "</p>" + "<p class='hours'>" + moment(day.openHour).format('hh:mm A') + " - " + moment(day.closeHour).format('hh:mm A') + "</div>"
                        }
                    })
                    $(".schedule-wrapper").html(workingHtml)
                }
            })
        }

        function sortDaysOfWeek(data) {

            const sorter = {
                // "sunday": 0, // << if sunday is first day of week
                "monday": 1,
                "tuesday": 2,
                "wednesday": 3,
                "thursday": 4,
                "friday": 5,
                "saturday": 6,
                "sunday": 7
            }
            if (data) {
                data.sort(function sortByDay(a, b) {
                    let day1 = a.dayOfWeek.toLowerCase();
                    let day2 = b.dayOfWeek.toLowerCase();
                    return sorter[day1] - sorter[day2];
                });
            }

        }

        function setServices(bid, lpid, color, bgColorLight, isDefaultTheme) {

            $.ajax({
                url: getApiUrl() + "/api/public/v1/business/" + bid + "/services",
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },
                success: function(data, textStatus) {

                    if (data.length > 6) {
                        data = data.slice(0, 5)
                    }
                    data = data.filter(function(obj) {
                        return obj.name.toLowerCase() != "general";
                    });

                    $('.service-wrapper .service-wrapper2 a').attr("data-target", "#myModal")
                    $('.service-wrapper .service-wrapper2 a').attr("data-toggle", "modal")
                    var service_html = $('.service-wrapper')
                    let service_created_html = ""
                    data.forEach(function(slide) {
                        $('.stitle').text(slide.name);
                        $('.sdescription').text(slide.description);
                        $(".service-wrapper a").text("View Detail ...")
                        $(".service-wrapper a").prop("id", slide.id)
                        var sdiv = service_html.html()
                        service_created_html = service_created_html + sdiv
                    });
                    $("#service-insert").html(service_created_html)
                    if (data.length % 4 === 0) {
                        $("#service-insert .col-lg-4").addClass("col-xl-3");
                    }


                    $(".our-services .btn").css("background-color", color);
                    $('.service-wrapper').css("display", "none")
                    if (!isDefaultTheme) {
                        $("#service-insert .titlep").css("color", color);
                        $("#service-insert .circle-img").css("background-color", bgColorLight);
                    }
                }
            })
        }


        function setUsers(bid, lpid, bgColor, color, bgColorLight, isDefaultTheme) {
            $.ajax({
                url: getApiUrl() + "/api/public/v1/business/" + bid + "/users",
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },
                success: function(data, textStatus) {

                    data = data.filter(user => user.isProvider != null)

                    var str = "<div class='row mx-0'>"
                    var domain = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');

                    if ($(".custom-user-wrapper").length > 0) {
                        setCustomUsers(data, bid, lpid, bgColor, color, bgColorLight, isDefaultTheme)
                        console.log("true")


                    } else {
                        data.forEach(function(slide) {
                            if (slide.isProvider) {
                                let imgUrl = slide.profileImageUrl ? slide.profileImageUrl : 'https://g99plus.b-cdn.net/website1/profileDefault.png'
                                let appointbookingUrl = domain + "/ap-booking?b=" + bid + "&lpid=" + lpid + "&u="
                                appointbookingUrl += slide.id
                                str += "<div class='col-lg-4 col-md-6  col-sm-12'>" +
                                    "<div class='img-wrapper4'> " +
                                    "<div class='img4'>" +
                                    " <img src='" + imgUrl + "' style='max-width:100%;width:100%;border-radius:12px'>" +

                                    "</div>" +
                                    "<div class='content4'>"
                                str += "<p class='titlep' style='font-weight:700'>" + slide.firstName + "&nbsp" + slide.lastName + "</p>" +
                                    // "<p class='small-text'>" + slide.username + "</p>" +
                                    // "<p class='small-text'>" + slide.description + "</p>" +
                                    "<div class='buttons-wrapper'> " +
                                    "<button class='btn-book'  data-target='#myModal' data-toggle='modal' " + "id=" + slide.id + " " + "value=" + slide.providerBookingURl + ">View Profile</button>" +
                                    "<button class='btn btn-book' ><a target='_blank' href=" + appointbookingUrl + "> Book Now </a> </button>" +
                                    "</div></div></div>" +
                                    "</div>"
                            }

                        });
                        str += "</div>"
                        $("#users").html(str);

                        $("#landingPage button.btn a").css("color", color);
                        $("#landingPage button.btn").css("background-color", bgColor);
                        $("#landingPage button.btn").css("color", color);
                        $("#landingPage #personalizedColor").css("background-color", bgColorLight);

                        if (!isDefaultTheme) {
                            $("#users .titlep").css("color", bgColor);
                        }
                    }


                }
            })
        }

        function setCustomUsers(data, bid, lpid, bgColor, color, bgColorLight, isDefaultTheme) {
            $('.custom-user-wrapper .user-wrapper2 .btn-profile').attr("data-target", "#myModal")
            $('.custom-user-wrapper .user-wrapper2 .btn-profile').attr("data-toggle", "modal")
            var service_html = $('.custom-user-wrapper')
            let service_created_html = "<div class='row mx-0'>"

            var domain = location.protocol + '//' + location.hostname + (location.port ? ':' + location.port : '');
            data.forEach(function(slide) {
                if (slide.isProvider) {
                    let imgUrl = slide.profileImageUrl ? slide.profileImageUrl : 'https://g99plus.b-cdn.net/website1/profileDefault.png'
                    let appointbookingUrl = domain + "/ap-booking?b=" + bid + "&lpid=" + lpid + "&u="
                    appointbookingUrl += slide.id

                    let bookUrlHtml = "<a href='" + appointbookingUrl + "' target='_blank'>Book Now </a>"
                    console.log(bookUrlHtml, $(".custom-user-wrapper .btn-booking").length)

                    $('.user-img img').attr("src", imgUrl);
                    $('.utitle').text(slide.firstName + " " + slide.lastName);
                    $(".custom-user-wrapper .btn-booking").html(bookUrlHtml)
                    $(".custom-user-wrapper .btn-profile").prop("id", slide.id)
                    var sdiv = service_html.html()
                    service_created_html = service_created_html + sdiv
                }

            })
            $("#users").html(service_created_html)
            if (data.length % 4 === 0) {
                $("#users .col-lg-4").addClass("col-xl-3");
            }

            $('.custom-user-wrapper').css("display", "none")
            $("#landingPage button.btn a").css("color", color);
            $("#landingPage button.btn").css("background-color", bgColor);
            $("#landingPage .bgColorDark").css("background-color", bgColor);
            $("#landingPage button.btn").css("color", color);
        }


        function getUrlVars() {
            var vars = [],
                hash;
            var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }

        function getFormUrlVars(url) {
            var vars = [],
                hash;
            var hashes = url.slice(url.indexOf('?') + 1).split('&');
            for (var i = 0; i < hashes.length; i++) {
                hash = hashes[i].split('=');
                vars.push(hash[0]);
                vars[hash[0]] = hash[1];
            }
            return vars;
        }

        function setEmailAndPhoneNo() {
            let phoneNo = "tel:" + $(".top-left  a.tel").text().trim()
            let email = "mailto:" + $(".top-left  a.mail").text().trim()
            $(".top-left  a.mail").attr("href", email)
            $(".top-left  a.tel").attr("href", phoneNo)
                //$("a").attr("href", "http://www.google.com/")
        }

        //added symptom composer
        function setSymptomComposer(bgColor, color, bgColorLight) {
            SymptomComposerUrl = SymptomComposerUrl + "?color=" + color + "&bgColor=" + bgColor
            let iframStr = '<iframe src="' + SymptomComposerUrl + '" ></iframe>'
            $("#symtom-iframe").html(iframStr);

        }

        //settng book now url for book now
        function setBookingUrlfromDefaultClinic(bid, lpid, bgColor, color, bgColorLight) {
            $.ajax({
                url: getApiUrl() + "/api/public/v1/clinics/default",
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },
                success: function(data, textStatus) {
                    console.log(data)
                        //    ClinicUrl = data.clinicUrl
                    defaultClinicId = data.id
                    let clinic_url = domain + "/ap-booking/website?b=" + bid + "&c=" + data.id + "&lpid=" + lpid + "&color=" + color + "&bgColor=" + bgColor
                        //clinic_url = ClinicUrl + "/website" + "&lpid=" + lpid + "&color=" + color + "&bgColor=" + bgColor
                    let iframStr = '<iframe src="' + clinic_url + '" ></iframe>'
                    $("#booknow-iframe").html(iframStr);

                    var buttonCode = $('<div class="text-center reviewButtonCode"><button class="btn btn-primary">Review Us</button>').append(data.reviewButtonCode)
                    $("#testimonials .reviews").html(data.appReviewCode)
                    console.log(data.reviewButtonCode)
                        //   let reviewUsButton = '<button class="btn btn-book mb-3" ><a target="_blank" href="' + href + '" >Review Us </a></button>'

                    if (data.reviewButtonCode) {
                        $("#testimonials .content6").append(buttonCode)
                        $("#testimonials .reviewButtonCode button").css("background", bgColor)
                    }

                    $("#landingPage button.btn a").css("color", color);
                    $("#booknow-iframe iframe").css("min-height", "1000px");
                }
            })

        }


        function loadLandingPage(bid, lpid) {
            if (lpid) {
                $.ajax({
                    url: getApiUrl() + "/api/public/landingpage/" + lpid,
                    method: 'GET',
                    headers: {
                        'X-TenantID': '' + bid
                    },
                    success: function(data, textStatus) {
                        localStorage.setItem("api/public/landingpage/id", JSON.stringify(data))
                        var isDefaultTheme = true
                        buttoncss = data.buttonCSS;
                        lpname1 = data.name;


                        if (buttoncss != null) {
                            $('<style>').text(buttoncss).appendTo(document.head);
                        }


                        $("#landingPage").html(data.landingPageTemplate);

                        setDyanmicFooterYear();

                        if (data.buttonForegroundColor && data.buttonBackgroundColor) {
                            localStorage.setItem("color", data.buttonForegroundColor)
                            localStorage.setItem("bgColor", data.buttonBackgroundColor)
                            $("#landingPage button").css("background-color", data.buttonBackgroundColor);
                            $("#landingPage button").css("color", data.buttonForegroundColor);
                            $("#landingPage bgColor").css("color", bgColorLight);
                            $("#landingPage fgColor").css("color", data.buttonForegroundColor);
                            isDefaultTheme = false
                        }
                        var bgColor = $('.btn-fixed ').css("background-color");
                        var color = $('.btn-fixed ').css("color");
                        var bgColorLight = hexToRGB(bgColor, 0.15);
                        if (bgColorLight) {
                            global_bgColor_noOpactiy = rgbToHex(bgColorLight)
                        }

                        gloabl_fgColor = color
                        gloabl_bgColor = bgColor
                        gloabl_bgColorLight = bgColorLight
                        setServices(bid, lpid, bgColor, bgColorLight, isDefaultTheme)
                        setUsers(bid, lpid, bgColor, color, bgColorLight, isDefaultTheme)
                        loadClinicWorkingTime()
                        setSymptomComposer(bgColor, color, bgColorLight)
                            // setBookingUrl(bgColor, color, bgColorLight);
                        sessionStorage.setItem("optionalBgColor", bgColor)
                        sessionStorage.setItem("optionForegroundColor", color)

                        if (!isDefaultTheme) {
                            $("#landingPage button").css("background-color", data.buttonBackgroundColor);
                            $("#landingPage button").css("color", data.buttonForegroundColor);
                            $("#landingPage .bgColor").css("background-color", bgColorLight);
                            $("#landingPage .bgColorOpactiy").css("background-color", bgColorLight);
                            $("#landingPage .fgColorInBg").css("background-color", bgColor);
                            $("#landingPage .fgColor").css("color", data.buttonBackgroundColor);
                            $("#landingPage .icons a").css("color", data.buttonBackgroundColor);

                            $("#landingPage .border-color").css("border-color", data.buttonBackgroundColor);
                        }
                        $("#landingPage .fgColorInBg").css("background-color", bgColor);
                        // document.getElementsByName('Contact Form')[0].src = data.formUrl;
                        setEmailAndPhoneNo()
                        setBookingUrlfromDefaultClinic(bid, lpid, bgColor, color, bgColorLight)

                        $("#chatbot")
                            .append('<div  class="title">' + chatEmbededCode + '</div>');
                        document.title = data.name;

                        if (data.googleAnalyticsGlobalCodeUrl != null && data.googleAnalyticsGlobalCodeUrl != '') {

                            var s = document.createElement('script');
                            s.src = data.googleAnalyticsGlobalCodeUrl;
                            document.head.appendChild(s);
                            if (data.googleAnalyticsGlobalCode != null && data.googleAnalyticsGlobalCode != '') {
                                var str = data.googleAnalyticsGlobalCode;
                                str = str.replace(/<script>/g, '');
                                str = str.replace(/<\/script>/g, '');
                                var s1 = document.createElement('script');
                                s1.textContent = str;
                                document.head.appendChild(s1);
                            }
                        }

                        if (data.landingPageTrackCode != null && data.landingPageTrackCode != '') {
                            var str1 = data.landingPageTrackCode;
                            str1 = str1.replace(/<script>/g, '');
                            str1 = str1.replace(/<\/script>/g, '');
                            trackingCode = str1;

                        }

                        if (data.formUrl != null) {
                            formurl = data.formUrl;
                            formVariables = getFormUrlVars(formurl);
                            fid = formVariables['fid'];
                            bid = formVariables['bid'];
                            loadForm(bid, fid);
                        }

                        if (data.showPopupOnPageLoad != null &&
                            data.showPopupOnPageLoad) {
                            $("#myModal2").modal('show');
                        }

                        $('#personalizedColor').css("background-color", bgColorLight);
                        // $('#personalizedColor').css("opacity", 0.5);

                        $(document).ready(function() {
                            $("address").each(function() {
                                var embed = "<iframe width='425' height='350' frameborder='0' scrolling='no'  marginheight='0' marginwidth='0' src='https://maps.google.com/maps?&amp;q=" + encodeURIComponent($(this).text()) + "&amp;output=embed'></iframe>";
                                $(this).html(embed);
                            });
                        });

                        let currentPageUrl = window.location.href
                        setTimeout(() => {
                            var iFrames = document.getElementsByTagName('iframe');
                            for (let i = 0; i < iFrames.length; i++) {
                                let iframeString = iFrames[i].getAttribute('src')

                                if (iframeString && iframeString.indexOf("landing_page_form.html") >= 0) {
                                    console.log(iframeString, currentPageUrl)
                                    iFrames[i].contentWindow.postMessage(currentPageUrl, iframeString);
                                }
                            }
                        }, 5000)

                        // ! function(d, s, id) {
                        //     var js, fjs = d.getElementsByTagName(s)[0];
                        //     if (!d.getElementById(id)) {
                        //         js = d.createElement(s);
                        //         js.id = id;
                        //         js.src = "//platform.reviewmgr.com/widgets.js";
                        //         fjs.parentNode.insertBefore(js, fjs);
                        //     }
                        // }(document, "script", "reviewmgr-wjs");
                    }
                });
            }


        }

        function getApiUrl() {
            var hostname = window.location.hostname;
            if (hostname.includes("prod-app.growth99.com")) {
                return "https://api.growth99.com";
            } else if (hostname.includes("devemr.growthemr.com")) {
                return "https://api.growthemr.com";
            } else if (hostname.includes("localhost")) {
                return "https://api.growthemr.com";
            } else {
                return "https://api.growth99.com";
                // return "http://localhost:8080";
            }
        }

        function loadForm(bid, fid) {
            $.ajax({
                url: getApiUrl() + "/api/public/questionnaire/" + fid,
                method: 'GET',
                headers: {
                    'X-TenantID': '' + bid
                },
                success: function(data, textStatus) {

                    createForm(data, bid, fid);
                }
            });
        }

        function setDyanmicFooterYear() {
            $(".footer p:first").text(
                $(".footer p:first").text().replace("2021", new Date().getFullYear())
            );
        }

        function createForm(data, bid, fid) {


            var titleColor = "inherit";
            if (data.titleColor != null) {
                titleColor = data.titleColor;
            }
            var showTitle = true;
            if (data.showTitle != null) {
                showTitle = data.showTitle;
            }

            var hideFieldTitle = false;
            if (data.hideFieldTitle && data.hideFieldTitle != null) {
                hideFieldTitle = data.hideFieldTitle;
            }
            var disp = (showTitle) ? 'block' : 'none';
            var style = " style='margin: 0 0 15px;font-weight:normal;color:" + titleColor + ";display:" + disp + "' ";

            $("#formWrapper")
                .append('<h3' + style + '>' + data.questionnaireName + '<h3>')
                .append('<form action="#" method="POST" id="formId">');
            var patientQuestionAnswers = data.patientQuestionAnswers;
            for (var i = 0; i < patientQuestionAnswers.length; i++) {
                var question = patientQuestionAnswers[i];
                createInputElement(question, data, hideFieldTitle);
            }
            createButton(data);

            var inputBoxShadowColor = "#003B6F";
            if (data.inputBoxShadowColor != null) {
                inputBoxShadowColor = data.inputBoxShadowColor;
            }
            $("#formId input, #formId textarea").focusin(function() {
                $(this).css('box-shadow', " 0 0 0 0.05rem " + inputBoxShadowColor);
            }).focusout(function() {
                $(this).css('box-shadow', " 0 0 0 0rem " + inputBoxShadowColor);
            });

            $("body").removeClass("loading");
            $("#formId").submit(function(event) {

                event.preventDefault();
                $("body").addClass("loading");

                var formData = $("#formId").serializeArray();
                var keys = Object.keys(formData);
                var patientQuestionAnswers = [];
                keys.forEach(key => {
                    patientQuestionAnswers.push({
                        'questionId': formData[key].name,
                        'answerText': formData[key].value,
                        'questionType': $("#q_" + formData[key].name).attr("data-type")
                    });
                });


                var formReq = {
                    source: "Landing Page",
                    landingPageName: lpname1,
                    questionnaireId: fid,
                    sourceUrl: window.location.href,
                    patientQuestionAnswers: patientQuestionAnswers
                }

                $.ajax({
                    url: getApiUrl() + '/api/public/questionnaire/' + fid,
                    method: 'POST',
                    data: JSON.stringify(formReq),
                    contentType: 'application/json',
                    headers: {
                        'X-TenantID': '' + bid
                    },
                    success: function(response, statusText) {
                        // alert("Form submitted successfully.");
                        $("#myModal").modal('hide');
                        // document.getElementById("formId").reset();
                        var s2 = document.createElement('script');
                        s2.textContent = trackingCode;
                        document.head.appendChild(s2);

                    },
                    error: function(error) {
                        $("body").removeClass("loading");
                        alert("Unable to submit form. Please try again later.");
                    }
                })
            });
        }

        function createButton(data) {
            var buttonBackgroundColor = "#003B6F";
            var buttonForegroundColor = "#FFF";
            if (data.buttonBackgroundColor != null) {
                buttonBackgroundColor = data.buttonBackgroundColor;
            }

            if (data.buttonForegroundColor != null) {
                buttonForegroundColor = data.buttonForegroundColor;
            }

            var style = " style='background:" + buttonBackgroundColor + "; color:" + buttonForegroundColor + "'";

            $("#formId").append("<div class='app-row'>" +
                "<button type='submit' class='button' >Submit</button>" +
                "</div>");
        }

        function createInputElement(question, data, hideFieldTitle) {

            // required
            var req = "";
            var reqLabel = "";
            if (question.required) {
                req = "required='true'";
                reqLabel = "<span class='required'>*</span>";
            }

            var hiddenFieldTitleText = "";
            if (!hideFieldTitle) {

                hiddenFieldTitleText = " style='display:none' ";
            }
            // hidden
            var hidden = "";
            if (question.hidden != null && question.hidden === true) {
                hidden = " style='display:none' "
            }

            var inputBoxShadowColor = "#003B6F";
            if (data.inputBoxShadowColor != null) {
                inputBoxShadowColor = data.inputBoxShadowColor;
            }
            var inputStyle = ""; // " style='box-shadow: 0 0 0 0.05rem " + inputBoxShadowColor + "' ";

            if (question.questionType === "Input") {

                var h =
                    "<div class='app-row' " + hidden + ">" +
                    "<label class='label' " + hiddenFieldTitleText + ">" + question.questionName + reqLabel + "</label>" +
                    "<div>" +
                    "<input class='input'" + inputStyle + " type='text' data-type='" + question.questionType + "' id='q_" + question.questionId + "' name='" + question.questionId + "' placeholder='" + question.questionName + "' " + req + " />" +
                    "</div>" +
                    "</div>";
                $("#formId").append(h);

            } else if (question.questionType === "Text") {

                var h =
                    "<div class='app-row' " + hidden + ">" +
                    "<label class='label' " + hiddenFieldTitleText + ">" + question.questionName + reqLabel + "</label>" +
                    "<div>" +
                    "<textarea class='textarea' " + inputStyle + " data-type='" + question.questionType + "' id='q_" + question.questionId + "' name='" + question.questionId + "' placeholder='" + question.questionName + "' " + req + "></textarea>" +
                    "</div>" +
                    "</div>";
                $("#formId").append(h);
            } else if (question.questionType === "Yes_No") {

                var h =
                    "<div class='app-row' " + hidden + ">" +
                    "<label class='label' >" + question.questionName + reqLabel + "</label>" +
                    "<div>" +
                    "<input type='radio' class='radio' " + inputStyle + " data-type='" + question.questionType + "' id='q_" + question.questionId + "' name='" + question.questionId + "'> Yes" +
                    "&nbsp;&nbsp;<input type='radio' class='radio' " + inputStyle + " data-type='" + question.questionType + "' id='q_" + question.questionId + "' name='" + question.questionId + "'> No" +
                    "</div>" +
                    "<div style='display:none;color: red;margin-top: 7px;' id='v_" + question.questionId + "' >" +
                    "<span>" + question.validationMessage + "</span>" +
                    "</div>" +
                    "</div>";
                $("#formId").append(h);

            } else if (question.questionType === "Multiple_Selection_Text") {

                var qt = (question.allowMultipleSelection) ? "checkbox" : "radio";

                var h =
                    "<div class='app-row' " + hidden + ">" +
                    "<label class='label' >" + question.questionName + reqLabel + "</label>";
                for (var i = 0; i < question.patientQuestionChoices.length; i++) {
                    let qid = question.questionId + "_" + i;
                    h += "<div>" +
                        "<input " + inputStyle + " type='" + qt + "' class='' " +
                        " data-type='" + question.questionType + "' id='q_" + qid + "' name='" + question.questionId + "'" +
                        " value='" + question.patientQuestionChoices[i].choiceName + "'" +
                        "' placeholder='" + question.questionName + "' " + req +
                        " style='display:inline-block; max-width: 20px;' />" +
                        question.patientQuestionChoices[i].choiceName +
                        "</div>";

                }
            }
        }
    </script>
</body>

</html>


<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <div id="loading">
                    <div class="loaderModal">
                        <img src="https://s3.amazonaws.com/static.further/img/loading_vsa.gif">
                    </div>

                </div>


                <div id="service-data" style="display: none;">
                    <div class="service-header bgColor">
                        <h3 class="fgColor"></h3>
                    </div>
                    <div class="service-body">
                        <div class="row mx-0">
                            <div class="col-lg-5 col-md-12">
                                <img src="" width="100%" />
                            </div>
                            <div class="col-lg-7 col-md-12">
                                <div class="service-right">
                                    <!-- <div class="service-title">
                                        <h4 class="fgColor">

                                        </h4>
                                    </div> -->

                                    <div class="service-description">
                                        <p>

                                        </p>
                                    </div>

                                    <div class="service-other">
                                        <p class="mt-1">
                                            <b class="fgColor">
                                                Duration:
                                            </b> <span class="duration"></span>
                                        </p>
                                        <p class="mt-1">
                                            <b class="fgColor">
                                                Cost:
                                            </b>
                                            <span class="cost"></span>
                                        </p>

                                        <p class="mt-1">
                                            <b class="fgColor">
                                                Category:
                                            </b>
                                            <span class="category"></span>
                                        </p>
                                    </div>
                                    <div class="user-info-wrapper">
                                        <h5 class="fgColor">User working at Clinics</h5>
                                        <div class="user-clinics">

                                        </div>

                                        <div class="user-services">

                                        </div>
                                    </div>


                                    <div class="service-btn mt-2">
                                        <button class="btn-fixed1 btn-book">Book Now</button>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="myModal2" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <div id="formWrapper"></div>
                <div class="overlay">
                    <p style="text-align: center;
                    margin: 28% 0;">Processing...</p>
                </div>
                <div id="thankyou">
                    <div class="thanks">

                        <div class="thanks-content">
                            <div style="text-align:center;">
                                <h1 style="text-align: center;">Thank You!</h1>
                                <p style="text-align: center;">Your form has been submitted successfully.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
